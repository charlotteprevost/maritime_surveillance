<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <title>Dark Vessel Detection Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
  <link rel="stylesheet" href="css/style.css" />
</head>

<body>
  <header>
    <h1>Dark Vessel Detection Map</h1>
  </header>

  <main class="layout-container">
    <button id="about-toggle">About this data <span style="font-size:0.85em"></span></button>

    <div id="about-container" class="collapsed">
      <section class="about-data">
        <p>This map visualizes <strong>dark vessel detections</strong> by combining two data sources from 
          <a href="https://globalfishingwatch.org" target="_blank" rel="noopener noreferrer">Global Fishing Watch</a>:
        </p>
        
        <ul>
          <li><strong>Synthetic Aperture Radar (SAR) Detections</strong>: Vessels identified in Sentinel-1 radar satellite 
            imagery from the <a href="https://globalfishingwatch.org/data/datasets-and-code/public-global-sar-presence" 
            target="_blank" rel="noopener noreferrer">public-global-sar-presence dataset</a>. Each detection represents a 
            vessel classified by a deep learning model. Filtered for <code>matched=false</code> to show vessels not 
            broadcasting AIS during satellite overpass.</li>
          
          <li><strong>AIS Gap Events</strong>: Intentional AIS disabling events from the 
            <a href="https://globalfishingwatch.org/data/datasets-and-code/public-global-gaps-events" 
            target="_blank" rel="noopener noreferrer">public-global-gaps-events dataset</a>. These represent periods 
            when vessels intentionally turned off their Automatic Identification System transponders.</li>
        </ul>

        <p>Detections are shown within each country's <strong>Exclusive Economic Zone (EEZ)</strong>, which extends up to 
          200 nautical miles from a country's coastline. EEZ boundaries define maritime jurisdiction where coastal nations 
          have sovereign rights for resource management. Note: Some EEZs that cross the International Date Line (like 
          Alaska) are excluded from selection due to visualization limitations.</p>

        <p><strong>What are "dark vessels"?</strong><br>
          Dark vessels are ships that are not broadcasting their location via AIS. This can indicate:
          <ul>
            <li>Illegal, unreported, and unregulated (IUU) fishing activity</li>
            <li>Vessels attempting to avoid detection</li>
            <li>Technical AIS equipment failures (less common)</li>
          </ul>
        </p>

        <p><strong>How to use this map:</strong><br>
          Select one or more EEZs, choose a date range (up to 30 days), and click "Apply Filters" to see dark vessel 
          detections. The heatmap shows detection density, while individual markers represent specific vessel detections. 
          Click markers for detailed vessel information.</p>

        <p><strong>Data Sources:</strong><br>
          All data is provided by <a href="https://globalfishingwatch.org" target="_blank" rel="noopener noreferrer">Global Fishing Watch</a>, 
          an independent nonprofit organization that promotes ocean sustainability through transparency. Data is updated 
          regularly and typically available up to 5 days in arrears. For more information, visit 
          <a href="https://globalfishingwatch.org/our-apis" target="_blank" rel="noopener noreferrer">Global Fishing Watch APIs</a>.</p>
      </section>
    </div>

    <aside class="filters-panel">
      <div class="filters-intro">
        <strong>To use the map:</strong> Choose EEZ(s), a start and end date (up to 30 days), then click “Apply
        Filters.”
      </div>

      <div class="controls">
        <label for="eez-select">Select EEZ(s): <small>(Click to toggle, no Ctrl/Cmd needed)</small></label>
        <select id="eez-select" multiple size="5">
          <option value="" disabled>Select EEZ(s)…</option>
        </select>


        <div class="date-row">
          <div class="date-pair">
            <label for="start">Start Date:</label>
            <input type="date" id="start" />
          </div>
          <div class="date-pair">
            <label for="end">End Date:</label>
            <input type="date" id="end" />
          </div>
        </div>

        <section id="summary-stats" class="hidden">
          <h3>Detection Summary</h3>
          <ul id="summary-list"></ul>
        </section>

        <button id="applyFilters" disabled>Apply Filters</button>
      </div>
    </aside>
  </main>

  <div id="loading-spinner" class="hidden">
    <div class="spinner-text">Loading data...</div>
    <div id="progress-bar">
      <div id="progress-bar-fill"></div>
    </div>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script src="main.js" type="module"></script>
</body>

</html>